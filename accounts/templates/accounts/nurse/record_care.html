{% extends "base.html" %}

{% block content %}
<div class="nurse-container" style="background-color: #f5faf5; color: #2c3e50; min-height: 100vh;">
    <div class="nurse-header" style="background-color: #27ae60; color: white; padding: 20px; border-radius: 8px 8px 0 0;">
        <h2><i class="fas fa-hand-holding-medical"></i> Enregistrement des Soins</h2>
        <div class="patient-selector" style="margin-top: 15px;">
            <select id="patientSelect" class="form-select" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                <option value="">Sélectionnez un patient...</option>
                {% for patient in patients %}
                <option value="{{ patient.id }}">{{ patient.get_full_name }} - Chambre {{ patient.room_number|default:"N/A" }}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <form method="post" class="nurse-form" style="background-color: white; padding: 20px; border-radius: 0 0 8px 8px; margin-bottom: 20px;">
        {% csrf_token %}
        
        <div class="form-section" style="margin-bottom: 20px;">
            <h3 style="color: #27ae60; border-bottom: 2px solid #27ae60; padding-bottom: 5px;"><i class="fas fa-clipboard-list"></i> Type de Soin</h3>
            <div class="form-row" style="display: flex; gap: 15px; margin-bottom: 15px;">
                <div class="form-group" style="flex: 1;">
                    <label for="care_type" style="display: block; margin-bottom: 5px; font-weight: bold;">Type de soin</label>
                    <select id="care_type" name="care_type" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                        <option value="">Sélectionner...</option>
                        <option value="DRESSING">Pansement</option>
                        <option value="INJECTION">Injection</option>
                        <option value="PERFUSION">Perfusion</option>
                        <option value="HYGIENE">Soin d'hygiène</option>
                        <option value="OTHER">Autre</option>
                    </select>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="care_time" style="display: block; margin-bottom: 5px; font-weight: bold;">Heure du soin</label>
                    <input type="time" id="care_time" name="care_time" required 
                           style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"
                           value="{% now 'H:i' %}">
                </div>
            </div>
            
            <div class="form-group" style="margin-bottom: 15px;">
                <label for="care_description" style="display: block; margin-bottom: 5px; font-weight: bold;">Description détaillée</label>
                <textarea id="care_description" name="care_description" rows="4" 
                          style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"
                          placeholder="Décrire le soin effectué..."></textarea>
            </div>
        </div>

        <div class="form-section" style="margin-bottom: 20px;">
            <h3 style="color: #27ae60; border-bottom: 2px solid #27ae60; padding-bottom: 5px;"><i class="fas fa-comment-medical"></i> Observations</h3>
            <div class="form-group" style="margin-bottom: 15px;">
                <label for="observations" style="display: block; margin-bottom: 5px; font-weight: bold;">État du patient pendant le soin</label>
                <textarea id="observations" name="observations" rows="3" 
                          style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"
                          placeholder="Réactions, comportement, douleurs..."></textarea>
            </div>
            
            <div class="form-row" style="display: flex; gap: 15px;">
                <div class="form-group" style="flex: 1;">
                    <label for="pain_level" style="display: block; margin-bottom: 5px; font-weight: bold;">Niveau de douleur (0-10)</label>
                    <input type="range" id="pain_level" name="pain_level" min="0" max="10" value="0" 
                           style="width: 100%;"
                           oninput="document.getElementById('painValue').textContent = this.value + '/10'">
                    <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                        <span>0</span>
                        <span id="painValue" style="font-weight: bold;">0/10</span>
                        <span>10</span>
                    </div>
                </div>
                <div class="form-group" style="flex: 1;">
                    <label for="medication_given" style="display: block; margin-bottom: 5px; font-weight: bold;">Médicament administré</label>
                    <input type="text" id="medication_given" name="medication_given" 
                           style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;"
                           placeholder="Nom du médicament">
                </div>
            </div>
        </div>

        <div class="form-actions" style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
            <button type="submit" class="btn btn-save" 
                    style="background-color: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">
                <i class="fas fa-save"></i> Enregistrer le Soin
            </button>
            <a href="{% url 'dashboard' %}" class="btn btn-cancel"
               style="background-color: #e74c3c; color: white; padding: 10px 20px; border: none; border-radius: 4px; text-decoration: none; display: inline-block;">
                <i class="fas fa-times"></i> Annuler
            </a>
        </div>
    </form>
</div>

<script>
document.getElementById('patientSelect').addEventListener('change', function() {
    const patientId = this.value;
    if (patientId) {
        // Ici vous pourriez charger les informations du patient via AJAX
        console.log("Patient sélectionné:", patientId);
    }
});
</script>
{% endblock %}